# 数据库用户存储系统说明

## 概述

本项目已成功集成了完整的数据库用户存储系统，可以存储用户的工作经历、联系方式、毕业院校、职业技能等信息。

## 数据库设计

### 表结构

#### 1. 用户表 (users)
- `id`: 主键，自增
- `username`: 用户名，唯一
- `email`: 邮箱，唯一
- `password_hash`: 密码哈希
- `full_name`: 真实姓名
- `phone`: 手机号
- `created_at`: 创建时间
- `updated_at`: 更新时间
- `is_active`: 是否激活

#### 2. 工作经历表 (work_experiences)
- `id`: 主键，自增
- `user_id`: 外键，关联用户
- `company`: 公司名称
- `position`: 职位
- `start_date`: 开始日期
- `end_date`: 结束日期（可为空）
- `is_current`: 是否当前工作
- `description`: 工作描述
- `achievements`: 工作成就
- `created_at`: 创建时间
- `updated_at`: 更新时间

#### 3. 教育背景表 (education_backgrounds)
- `id`: 主键，自增
- `user_id`: 外键，关联用户
- `school`: 学校名称
- `major`: 专业
- `degree`: 学位（学士、硕士、博士等）
- `start_date`: 开始日期
- `end_date`: 结束日期（可为空）
- `gpa`: 绩点
- `description`: 描述
- `created_at`: 创建时间
- `updated_at`: 更新时间

#### 4. 技能表 (skills)
- `id`: 主键，自增
- `user_id`: 外键，关联用户
- `name`: 技能名称
- `category`: 技能分类（编程语言、框架、工具等）
- `proficiency_level`: 熟练程度（初级、中级、高级、专家）
- `description`: 描述
- `created_at`: 创建时间
- `updated_at`: 更新时间

#### 5. 简历表 (resumes)
- `id`: 主键，自增
- `user_id`: 外键，关联用户
- `title`: 简历标题
- `content`: 简历内容（JSON格式）
- `is_public`: 是否公开
- `is_default`: 是否默认简历
- `created_at`: 创建时间
- `updated_at`: 更新时间

#### 6. 用户会话表 (user_sessions)
- `id`: 主键，自增
- `user_id`: 外键，关联用户
- `session_token`: 会话令牌
- `expires_at`: 过期时间
- `created_at`: 创建时间
- `is_active`: 是否激活

## API接口

### 用户认证
- `POST /api/register` - 用户注册
- `POST /api/login` - 用户登录
- `POST /api/logout` - 用户登出
- `GET /api/profile` - 获取用户资料
- `PUT /api/profile` - 更新用户资料

### 工作经历管理
- `GET /api/work-experiences` - 获取工作经历列表
- `POST /api/work-experiences` - 创建工作经历
- `PUT /api/work-experiences/<id>` - 更新工作经历
- `DELETE /api/work-experiences/<id>` - 删除工作经历

### 教育背景管理
- `GET /api/education` - 获取教育背景列表
- `POST /api/education` - 创建教育背景

### 技能管理
- `GET /api/skills` - 获取技能列表
- `POST /api/skills` - 创建技能

### 简历管理
- `GET /api/resumes` - 获取简历列表
- `POST /api/resumes` - 创建简历

## 使用方法

### 1. 初始化数据库
```bash
python init_db.py init
```

### 2. 重置数据库
```bash
python init_db.py reset
```

### 3. 查看数据库信息
```bash
python init_db.py info
```

### 4. 启动应用
```bash
python run.py
# 或
python app.py
```

## 前端功能

### 用户管理
- 用户注册和登录
- 个人资料管理
- 会话管理

### 数据管理
- 工作经历管理
- 教育背景管理
- 技能管理
- 简历管理

### 界面特色
- 响应式设计
- 模态框交互
- 标签页切换
- 实时数据更新

## 示例数据

系统初始化时会创建示例用户：
- 用户名: `demo_user`
- 密码: `123456`
- 邮箱: `demo@example.com`

包含完整的工作经历、教育背景、技能和简历数据。

## 技术栈

- **后端**: Flask + SQLAlchemy
- **数据库**: SQLite (可配置为其他数据库)
- **前端**: HTML5 + CSS3 + JavaScript
- **认证**: 基于令牌的会话管理
- **密码**: Werkzeug 安全哈希

## 配置选项

### 环境变量
- `DATABASE_URL`: 数据库连接字符串
- `SECRET_KEY`: Flask 密钥
- `DASHSCOPE_API_KEY`: 阿里云百炼平台API密钥

### 数据库配置
默认使用 SQLite，生产环境建议使用 PostgreSQL 或 MySQL。

## 安全特性

- 密码哈希存储
- 会话令牌管理
- 输入验证
- SQL 注入防护
- XSS 防护

## 扩展功能

系统设计支持以下扩展：
- 文件上传（头像、证书等）
- 社交功能（关注、分享）
- 简历模板系统
- 数据分析统计
- 邮件通知系统

## 故障排除

### 常见问题

1. **数据库连接失败**
   - 检查数据库文件权限
   - 确认数据库路径正确

2. **用户认证失败**
   - 检查会话令牌
   - 确认用户状态

3. **数据加载失败**
   - 检查网络连接
   - 确认API端点正确

### 调试模式
启动时添加调试参数：
```bash
python app.py --debug
```

## 性能优化

- 数据库索引优化
- 查询缓存
- 分页加载
- 懒加载

## 部署建议

### 生产环境
- 使用 PostgreSQL 数据库
- 配置 Redis 缓存
- 启用 HTTPS
- 设置环境变量
- 使用 Gunicorn 部署

### Docker 部署
```dockerfile
FROM python:3.9
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
EXPOSE 5000
CMD ["python", "app.py"]
```

---

**注意**: 请确保在生产环境中修改默认的密钥和配置，并定期备份数据库。
